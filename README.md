# Bing每日壁纸下载器

必应每日壁纸自动下载工具，支持自动清理、幻灯片播放和静默运行。一个简单但功能完整的Windows壁纸管理解决方案。

## 功能特点

1. **自动下载必应壁纸**
   - 下载当天的必应壁纸
   - 自动检查并补充下载最近5天的壁纸（包括今天）
   - 下载超高清版本（3840x2160分辨率）

2. **智能文件管理**
   - 使用日期作为文件名（例如：20240224.jpg）
   - 自动维护文件夹整洁度：
     * 保留最新的5张图片（按文件名日期排序）
     * 自动删除更早的图片
     * 每次下载完成后自动执行清理
   - 自动跳过已下载的图片，避免重复下载

3. **日志记录**
   - 详细记录下载过程和错误信息
   - 自动清理过大的日志文件（超过1MB时自动清理）
   - 使用分隔符让日志更清晰易读

4. **静默运行**
   - 支持后台静默运行
   - 自动等待网络连接
   - 支持开机/登录时自动执行

## 部署说明

### 1. 环境要求
- Windows 10/11
- Python 3.x
- 必要的Python包：`pip install -r requirements.txt`

### 2. 文件说明
- `bing_wallpaper.py`: 主程序
- `run_wallpaper.bat`: 批处理文件，负责执行程序和日志管理
- `run_wallpaper.vbs`: VBS脚本，用于静默运行
- `requirements.txt`: Python依赖包列表
- `wallpaper_log.txt`: 运行日志文件

### 3. 配置说明
在 `bing_wallpaper.py` 中可以修改以下配置：
```python
CONFIG = {
    "download_dir": "E:\\WallPapers",  # 壁纸保存目录
    "keep_images": 5,                   # 保留的图片数量
    "check_days": 5                     # 检查的天数范围
}
```

### 4. 设置开机自动运行

#### 方法：使用Windows任务计划程序

1. 打开任务计划程序
   - 按 `Win + R`
   - 输入 `taskschd.msc`
   - 点击确定

2. 创建新任务
   - 在右侧面板点击"创建任务"
   - 常规选项卡：
     - 名称：`Bing壁纸下载`
     - 选择"使用最高权限运行"
     - 配置：选择适用于 Windows 10

3. 触发器设置
   - 点击"触发器"选项卡
   - 点击"新建"
   - 开始任务：选择"登录时"
   - 延迟任务：选择"10分钟"
   - 勾选"已启用"

4. 操作设置
   - 点击"操作"选项卡
   - 点击"新建"
   - 操作：启动程序
   - 程序/脚本：`wscript.exe`
   - 添加参数：`"完整路径\run_wallpaper.vbs"`
     - 例如：`"E:\Proj\WallPaper\run_wallpaper.vbs"`

5. 条件设置（可选）
   - 点击"条件"选项卡
   - 可以根据需要设置网络条件等

6. 设置选项卡
   - 根据需要设置其他选项
   - 建议勾选"允许按需运行任务"

### 5. 运行测试
1. 直接运行测试：
   - 双击 `run_wallpaper.vbs` 运行
   - 查看 `wallpaper_log.txt` 确认运行状态

2. 检查下载的图片：
   - 打开配置的下载目录（默认 `E:\WallPapers`）
   - 确认图片是否正确下载

## 设置壁纸幻灯片（Windows 11）

1. 打开Windows设置
   - 按 `Win + I` 打开设置
   - 或点击开始菜单，选择"设置"

2. 进入个性化设置
   - 点击"个性化"
   - 选择"背景"

3. 设置幻灯片背景
   - 在"个性化背景"下拉菜单中选择"幻灯片放映"
   - 点击"浏览"选择图片文件夹
   - 选择程序的下载目录（默认为 `E:\WallPapers`）

4. 配置幻灯片选项
   - 选择切换图片的时间间隔（建议：30分钟或1小时）
   - 可以选择"随机顺序"，让壁纸随机切换
   - 建议开启"当使用电池电源时，让幻灯片放映继续播放"

5. 优化设置
   - 在"选择适合屏幕的方式"中，建议选择"填充"或"适应"
   - 这样可以确保超高清壁纸最佳显示效果

这样设置后，Windows会自动在指定的时间间隔内切换显示下载目录中的壁纸。由于程序会自动维护最新的5张图片，所以幻灯片始终会显示最新的必应壁纸。

## 注意事项

1. 确保所有文件路径正确
2. 确保Python环境已正确配置
3. 如果修改了文件位置，需要同步修改相关脚本中的路径
4. 建议定期检查日志文件，确保程序正常运行 